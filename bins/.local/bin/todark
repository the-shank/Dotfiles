#!/bin/bash

# Update themes for:
# [x] xfce-terminal
# [x] nvim
# [x] gtk theme
# [x] mousepad

set -eu
set -o pipefail

# xfce-terminal
xfconf-query --channel xfce4-terminal --property /color-background --set "#2D353B"
xfconf-query --channel xfce4-terminal --property /color-background-vary --set false
# xfconf-query --channel xfce4-terminal --property /color-bold --set "#073642"
xfconf-query --channel xfce4-terminal --property /color-bold-is-bright --set true
xfconf-query --channel xfce4-terminal --property /color-bold-use-default --set true
xfconf-query --channel xfce4-terminal --property /color-cursor --set "#D3C6AA"
xfconf-query --channel xfce4-terminal --property /color-cursor-use-default --set false
xfconf-query --channel xfce4-terminal --property /color-foreground --set "#D3C6AA"
xfconf-query --channel xfce4-terminal --property /color-palette --set "#4B565C;#E67E80;#A7C080;#DBBC7F;#7FBBB3;#D699B6;#83C092;#D3C6AA;#5C6A72;#F85552;#8DA101;#DFA000;#3A94C5;#DF69BA;#35A77C;#DFDDC8"
# xfconf-query --channel xfce4-terminal --property /color-selection-background --set "#543A48"
xfconf-query --channel xfce4-terminal --property /color-selection-use-default --set true
xfconf-query --channel xfce4-terminal --property /color-use-theme --set false
xfconf-query --channel xfce4-terminal --property /tab-activity-color --set "#AA0000"

# nvim
# nvim-lazyvim
FILE=$HOME/.config/nvim-lazyvim/lua/config/options.lua
sed -i -e 's/vim.opt.background = ".*"/vim.opt.background = "dark"/' $FILE
# nvim-nvchad
FILE=$HOME/.config/nvim-nvchad/lua/custom/chadrc.lua
sed -i -e 's/theme = "everforest_light"/theme = "everforest"/' $FILE
sed -i -e 's/theme_toggle = { "everforest_light", "everforest" }/theme_toggle = { "everforest", "everforest_light" }/' $FILE

# gtk theme
# ref: https://felix-kling.de/blog/2021/linux-toggle-dark-mode.html
FILE=$HOME/.xsettingsd
if ! grep -q "Net/ApplicationPreferDarkTheme" ${FILE}; then
	echo "Net/ApplicationPreferDarkTheme 1" >>$FILE
else
	sed -i -e 's#Net/ApplicationPreferDarkTheme 0#Net/ApplicationPreferDarkTheme 1#' $FILE
fi
if ! grep -q "Gtk/ApplicationPreferDarkTheme" ${FILE}; then
	echo "Gtk/ApplicationPreferDarkTheme 1" >>$FILE
else
	sed -i -e 's#Gtk/ApplicationPreferDarkTheme 0#Gtk/ApplicationPreferDarkTheme 1#' $FILE
fi
if ! grep -q "Net/ThemeName" $FILE; then
	echo "Net/ThemeName \"Arc-Dark\"" >>$FILE
else
	sed -i -e 's#Net/ThemeName "Arc"#Net/ThemeName "Arc-Dark"#' $FILE
fi
if ! grep -q "Gtk/ThemeName" $FILE; then
	echo "Gtk/ThemeName \"Arc-Dark\"" >>$FILE
else
	sed -i -e 's#Gtk/ThemeName "Arc"#Gtk/ThemeName "Arc-Dark"#' $FILE
fi
killall -HUP xsettingsd
i3-msg reload

# mousepad
# ref: https://docs.xfce.org/apps/mousepad/start
gsettings set org.xfce.mousepad.preferences.view color-scheme solarized-dark
